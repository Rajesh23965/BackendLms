"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.buildLayout = exports.buildMjmlTemplate = exports.nodemailerMjmlPlugin = void 0;
const buildMjmlTemplate_1 = require("./helpers/buildMjmlTemplate");
Object.defineProperty(exports, "buildMjmlTemplate", { enumerable: true, get: function () { return buildMjmlTemplate_1.buildMjmlTemplate; } });
const buildLayout_1 = require("./helpers/buildLayout");
Object.defineProperty(exports, "buildLayout", { enumerable: true, get: function () { return buildLayout_1.buildLayout; } });
const nodemailerMjmlPlugin = (options) => {
    return async (mail, callback) => {
        if (mail.data.html || (!mail.data?.templateName && !mail.data?.templateLayoutName))
            return callback();
        try {
            const mailHtmlContent = await (0, buildMjmlTemplate_1.buildMjmlTemplate)(options, mail.data);
            Object.assign(mail.data, { html: mailHtmlContent });
            return callback();
        }
        catch (error) {
            return callback(error);
        }
    };
};
exports.nodemailerMjmlPlugin = nodemailerMjmlPlugin;
exports.default = nodemailerMjmlPlugin;
